DROP TABLE IF EXISTS "USUARIO";
CREATE TABLE IF NOT EXISTS public."USUARIO"
(
    "CHAVEUSU" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    "NOME" character varying(40) COLLATE pg_catalog."default",
    "APELIDO" character varying(15) COLLATE pg_catalog."default",
    "DTNASCIMENTO" date,
    "CPF" character(14) COLLATE pg_catalog."default",
    "SEXO" "char" NOT NULL,
    "LOGIN" character varying(30) COLLATE pg_catalog."default",
    "SENHA" character varying(15) COLLATE pg_catalog."default",
    CONSTRAINT "CHAVEUSU_pkey" PRIMARY KEY ("CHAVEUSU")
);

DROP TABLE IF EXISTS "MODALIDADE";
CREATE TABLE IF NOT EXISTS public."MODALIDADE"
(
    "CHAVEMOD" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    "NOME" character varying(30) COLLATE pg_catalog."default",
    CONSTRAINT "CHAVEMOD_pkey" PRIMARY KEY ("CHAVEMOD"),
);

DROP TABLE IF EXISTS "TURMA";
CREATE TABLE IF NOT EXISTS public."TURMA"
(
    "CHAVETUR" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    "CHAVEUSU" bigint NOT NULL,
    "CHAVEMOD" bigint NOT NULL,
    "HRINICIO" time without time zone NOT NULL,
    "HRFIM" time without time zone NOT NULL,
    "DIASSEMANA" character varying(7) COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT "CHAVETUR_pkey" PRIMARY KEY ("CHAVETUR"),
    CONSTRAINT "fk_TURMA_MODALIDADE" FOREIGN KEY ("CHAVEMOD")
        REFERENCES public."MODALIDADE" ("CHAVEMOD") MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT "fk_TURMA_USUARIO" FOREIGN KEY ("CHAVEUSU")
        REFERENCES public."USUARIO" ("CHAVEUSU") MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
);

DROP TABLE IF EXISTS "PERFIL";
CREATE TABLE IF NOT EXISTS public."PERFIL"
(
    "CHAVEPER" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 0 MINVALUE 0 MAXVALUE 9223372036854775807 CACHE 1 ),
    "CHAVEUSU" bigint NOT NULL,
    "TIPO" "char",
    CONSTRAINT "PERFIL_pkey" PRIMARY KEY ("CHAVEPER"),
    CONSTRAINT "fk_PERFIL_USUARIO" FOREIGN KEY ("CHAVEUSU")
        REFERENCES public."USUARIO" ("CHAVEUSU") MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
);

DROP TABLE IF EXISTS "GRADUACAO";
CREATE TABLE IF NOT EXISTS public."GRADUACAO"
(
    "CHAVEGRD" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    "CHAVEMOD" bigint NOT NULL,
    "NOME" character varying(30) COLLATE pg_catalog."default" NOT NULL,
    "ORDEM" bigint NOT NULL,
    "MINAULAS" integer NOT NULL,
    CONSTRAINT "CHAVEGRD_pkey" PRIMARY KEY ("CHAVEGRD"),
    CONSTRAINT "fk_GRADUACAO_MODALIDADE" FOREIGN KEY ("CHAVEMOD")
        REFERENCES public."MODALIDADE" ("CHAVEMOD") MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
);

DROP TABLE IF EXISTS "ALUNO";
CREATE TABLE IF NOT EXISTS public."ALUNO"
(
    "CHAVEALU" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    "CHAVEUSU" bigint NOT NULL,
    "CHAVEGRD" bigint NOT NULL,
    "NUMAULAS" integer NOT NULL DEFAULT 0,
    CONSTRAINT "CHAVEALU_pkey" PRIMARY KEY ("CHAVEALU"),
    CONSTRAINT "fk_ALUNO_GRADUACAO" FOREIGN KEY ("CHAVEGRD")
        REFERENCES public."GRADUACAO" ("CHAVEGRD") MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT "fk_ALUNO_USUARIO" FOREIGN KEY ("CHAVEUSU")
        REFERENCES public."USUARIO" ("CHAVEUSU") MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
);

DROP TABLE IF EXISTS "CADPENDENTE";
CREATE TABLE IF NOT EXISTS public."CADPENDENTE"
(
    "CHAVECAD" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    "NOME" character varying(40) COLLATE pg_catalog."default",
    "APELIDO" character varying(15) COLLATE pg_catalog."default",
    "DTNASCIMENTO" date,
    "CPF" character(14) COLLATE pg_catalog."default",
    "SEXO" "char" DEFAULT 'I'::"char",
    "LOGIN" character varying(30) COLLATE pg_catalog."default",
    "SENHA" character varying(15) COLLATE pg_catalog."default",
    "TIPO" "char" NOT NULL DEFAULT 'A'::"char",
    "CHAVEMOD" bigint,
    "CHAVEUSU" bigint,
    "TIPOCADASTRO" "char" NOT NULL DEFAULT 'E'::"char",
    CONSTRAINT "CHAVECAD_pkey" PRIMARY KEY ("CHAVECAD"),
    CONSTRAINT "fk_CADPENDENTE_MODALIDADE" FOREIGN KEY ("CHAVEMOD")
        REFERENCES public."MODALIDADE" ("CHAVEMOD") MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
        NOT VALID,
    CONSTRAINT "fk_CADPENDENTE_USUARIO" FOREIGN KEY ("CHAVEUSU")
        REFERENCES public."USUARIO" ("CHAVEUSU") MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
        NOT VALID
);

DROP TABLE IF EXISTS "PRESENCA";
CREATE TABLE IF NOT EXISTS public."PRESENCA"
(
    "CHAVEPRE" bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    "CHAVEALU" bigint NOT NULL,
    "CHAVETUR" bigint NOT NULL,
    CONSTRAINT "CHAVEPRE_pkey" PRIMARY KEY ("CHAVEPRE"),
    CONSTRAINT "fk_PRESENCA_ALUNO" FOREIGN KEY ("CHAVEALU")
        REFERENCES public."ALUNO" ("CHAVEALU") MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
        NOT VALID,
    CONSTRAINT "fk_PRESENCA_TURMA" FOREIGN KEY ("CHAVETUR")
        REFERENCES public."TURMA" ("CHAVETUR") MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
);

/* Alterando a vers√£o para 5 */
SELECT setval('public."VERSAOBD"', 5, true);